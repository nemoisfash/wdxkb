<#assign modulePath="${adminPath}/machine"/>
<@layout.override name="body">
<style>
	.thum{
		padding: 4px;
	    margin-bottom: 20px;
	    line-height: 1.42857143;
	    background-color: #fff;
	    border: 1px solid #ddd;
	    border-radius: 4px;
	    -webkit-transition: border .2s ease-in-out;
	    -o-transition: border .2s ease-in-out;
	    transition: border .2s ease-in-out;
	    height: 357px;
	    margin: 10px;
	}
	.machineStatus-running{
	    background-color:#12b07b;
	    color: white;
	}
	.machineStatus-poweroff{
	    background-color:#a6a5a5;
	    color: white;
	}
	
	.machineStatus-waiting{
	    background-color:#feb501;
	    color: white;
	}
	
	.machineStatus-alarm{
	    background-color:#e65a65;
	    color: white;
	}
</style>
<div class="row" ng-app="myApp" ng-controller="myCtrl">
			<input type="hidden" id="uuid" ng-model="uuid" value="${(filters.uuid)!}">
			<div class="col-xs-12">
			<div class="box box-success">
            <div class="box-header">
              <h3 class="box-title">设备管理</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <div id="example1_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
              	<div class="row">
						<div class="col-sm-6">
						 		<div class="box-tools">
					                <div class="input-group input-group-sm" style="width: 300px;">
					                  <input type="text" name="table_search" 
					                  class="form-control pull-right" ng-model="value" placeholder="输入设备名称">
					                  <div class="input-group-btn">
					                    <button type="button" class="btn btn-default" ng-click="search()">
					                    	<i class="fa fa-search"></i>
					                    </button>
					                  </div>
					                </div>
					                <button type="button" class="btn btn-warning btn-sm search_adv_btn">
					                     	高级搜索
					                 </button>
				              </div>
						</div>
				</div>
				<div class="row search_adv_box" style="left:25px;top:80px">
					<div class="search_adv_row">
						<div class="search_adv_label">机台类型</div>
						<div class="search_adv_items">
							<a href="javascript:;" ng-click="removeFilter('type')" class="${fn.search_adv_item_cur(filters, 'type')}">不限</a>
							<@sys.optionList groupId='42'; items>
							<a href="javascript:;" ng-click="updateFilter('type', ${(items.id)!})" class="${fn.search_adv_item_cur(filters, 'type', '${(items.id)!}')}">${(items.name)!}</a>
							</@sys.optionList>
						</div>
					</div>
				</div>
				<div class="row" >
					<div class="col-sm-12">
						<table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info">
          					<thead>
               					<tr role="row">
									<th rowspan="1" colspan="1" style="width:100px;">机台名称</th>
									<th rowspan="1" colspan="1"  style="width:100px;">机台编号</th>
									<!-- <th rowspan="1" colspan="1"  style="width:100px;">机台类型</th> -->
									<th rowspan="1" colspan="1"  style="width:100px;">机台IP</th>
									<th rowspan="1" colspan="1"  style="width:50px;text-align:center;">图片</th>
									<th rowspan="1" colspan="1"  style="width:100px;text-align:right;">操作</th>
								</tr>
                			</thead>
							<tbody>
							 <tr role="row" class="odd" ng-repeat="item in items">
							   <td>{{item.name}}</td>
							   <td>{{item.code}}</td>
							   <td>{{item.mIp}}</td>
							   <td style="text-align:center;">
									<a id="preview_btn" class="btn btn-success btn-xs" ng-if="item.imgUrl==null" ng-click="editImg(item.id)" title="上传">
										<i class="fa fa-cloud-upload" aria-hidden="true"></i>
									</a>
									<a id="preview_btn" class="btn btn-default btn-xs" ng-if="item.imgUrl!=null" ng-click="editImg(item.id,item.imgUrl)" title="预览">
									 <i class="fa fa-eye" aria-hidden="true"></i>
									</a>
							   </td>
							   <td style="text-align:right;">
								   <a class="btn btn-default btn-xs" ng-click="machineData(item.id,item.name,item.imgUrl,item.status)" title="实时数据">
								   	<i class="fa fa-info-circle" aria-hidden="true"></i>
									</a>
							   </td>
							 </tr>
							</tbody>
              			</table>
             	 	</div>
              </div>
	            	<div class="row">
	             		<div class="col-sm-5">
							<div class="dataTables_info" id="example1_info" role="status" aria-live="polite">
								<span class="label label-default">共{{count}}台</span>
							</div>
							</div>
							<div class="col-sm-7" style="float:right;text-align: right;">
							<div class="pull-right tcdPageCode"></div>
							</div>
					</div>
    			</div>
            </div>
          </div>
          <!--图片预览 start-->
			<div id="boxPreview" style="display:none; text-align:center; margin:0px auto;width:630px;height:500px">
				<div class="thum">
					<img id="imgPreview" height="100%" width="100%" src="" alt="图片预览">
				</div>
				<div class="col-sm-7" style="position:relative;left:266px;top:79px;">
				  <label for="upload" class="btn btn-success btn-sm" style="margin-right:10px;">选择图片</label>
				  <input type="file" id="upload" style="display:none">
				  <label class="btn btn-warning btn-sm" ng-click="uploadImg()">确定上传</label>
				</div>
			</div>
			 <!--图片预览 end-->
		</div>
        <!--设备实时数据start  -->
	      	<div id="realTime">
					<div class="box box-primary" style="width:88%;height:400px;margin-left:14px;">
					<div id="machineStatus-header" class="box-header machineStatus-running">
						<h3 class="box-title">设备 {{machineName}}</h3>
					</div>
					<div class="box-body">
					<div class="media" style="width:600px;">
						  <div class="media-left">
						     <img width="200px" class="thumbnail" src="/themes/website/images/default.jpg" alt="通用的占位符缩略图">
						  </div>
						  <div class="media-body">
						  	<div class="form-group">
		    					<div class="input-group">
		    						<table class="table">
									  <tbody>
									    <tr>
									      <th>主轴倍率:</th>
									      <td>Bangalore</td>
									      <th>进给倍率:</th>
									      <td>Bangalore</td>
									    </tr>
									    <tr>
									      <th>主轴负载:</th>
									      <td>Bangalore</td>
									      <th>当前程序语句:</th>
									      <td>Bangalore</td>
									    </tr>
									    <tr>
									      <th>累计加工数量:</th>
									      <td>Bangalore</td>
									      <th>主轴实际转速:</th>
									      <td>Bangalore</td>
									    </tr>
									    <tr>
									      <th>当前刀具编号:</th>
									      <td>Bangalore</td>
									      <th>累计生产件数:</th>
									      <td>Bangalore</td>
									    </tr>
									  </tbody>
									</table>
		    					</div>
						  	</div>
						  </div>
						</div>
						<div class="panel panel-default">
							<div class="panel-heading">
							      <h3 class="panel-title">
							         	设备状态时间线
							      </h3>
							</div>
						    <div class="panel-body" style="height:121px" id="timeLine">
						    	
						    </div>
						</div>
					</div>
				</div>
          </div>
	</div>
</@layout.override>
<@layout.override name="js">
<@layout.super/>
<script src="/assets/uploadfile/fileUploadByFormData.js"></script>
<script src="/themes/admin/machine/js/gaugeOption.js"></script>
<!-- <script src="/themes/admin/machine/js/lineOption.js"></script> -->
<!-- <script src="/themes/admin/machine/js/pieOption.js"></script> -->
<script src="/themes/website/mycharts/controller/option/timelineOption.js"></script>
<script src="/themes/admin/machine/js/machine.js"></script>
</@layout.override>
<@layout.extends name="../../_layouts/bootstrap1.html"/>